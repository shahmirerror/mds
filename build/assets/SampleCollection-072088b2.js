import{r as t,W as P,j as e,a as k}from"./app-4431c5fe.js";import{A as B}from"./AuthenticatedLayout-59639fa7.js";import"./TextInput-4c395509.js";import{Q as R,B as a}from"./ReactToastify-4595696f.js";import{I as H}from"./IconRefresh-2b3191b2.js";import"./createReactComponent-3ce27679.js";import"./index-23e86464.js";function Q(i){const[n,j]=t.useState(null),[o,N]=t.useState(null),[c,v]=t.useState(null),[d,y]=t.useState(!1),[_,p]=t.useState(i.token_no);t.useState(i.in_queue);const[s,m]=t.useState(null);t.useState(!1);const[h,b]=t.useState(!1);t.useState("");const{data:f,setData:C,post:D,processing:F,errors:T,reset:q}=P({notes:"",biometric_fingerprint:""}),S=async r=>{m(null);const g={centre_id:i.auth.user.centre.centre_id,barcode:n,serial_no:c,reg_date:o,process_id:4},x=JSON.stringify(g);if(c==null&&o==null&&n==null)a.warning("Please select date & serial number or input barcode number to proceed!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"});else try{const u=await a.promise(fetch(route("lab.fetch_registration"),{method:"POST",body:x}),{pending:"Fetching Candidate"}).then(l=>l.json()).then(l=>{l.registration.length==0?a.warning("No Registration Found!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}):(b(!0),m(l.registration),p("M"+l.registration.token_no),l.verified?(y(l.verified),a.warning("Candidate Sample Already Collected!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})):a.success("Candidate Found!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}))},l=>{a.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}catch{a.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}},O=async r=>{const g={centre_id:i.auth.user.centre.centre_id,token_no:s.token_no,notes:f.notes,reg_date:s.reg_date,reg_id:s.reg_id},x=JSON.stringify(g);try{const u=await a.promise(fetch(route("lab.collect_sample"),{method:"POST",body:x}),{pending:"Submitting Form"}).then(l=>l.json()).then(l=>{p("None"),w(),a.success("Sample Collected!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})},l=>{a.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}catch{a.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}},w=r=>{m(null),j(""),N(""),v(""),b(!1)};return e.jsxs(B,{user:i.auth.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Blood Sample Collection"}),children:[e.jsx(k,{title:"Blood Sample Collection"}),e.jsx(R,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsx("div",{className:"page-header d-print-none",children:e.jsx("div",{className:"container-xl",children:e.jsx("div",{className:"row g-2 align-items-center",children:e.jsxs("div",{className:"col align-items-center",children:[e.jsx("div",{className:"col-md-3",style:{float:"left"},children:e.jsx("h2",{className:"page-title",style:{float:"left"},children:"Blood Sample Collection"})}),e.jsx("div",{className:"col-md-3 align-items-center",style:{float:"right"},children:e.jsxs("h2",{className:"page-title",children:[e.jsx("button",{className:"btn btn-secondary btn-sm mr-5 btn-pill",onClick:()=>location.reload(),children:e.jsx(H,{})}),e.jsxs("span",{className:"badge",children:["Current Token: ",_]})]})})]})})})}),e.jsx("div",{className:"page-body",children:e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"row row-cards mb-5",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"row row-cards",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"col-md-12 flex align-items-center",children:e.jsx("div",{className:"col-md-12",style:{float:"left"},children:e.jsx("h3",{children:"Biometric Verification"})})})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"row g-3",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"row g-3 align-items-center justify-content-center",children:[e.jsx("img",{id:"fingerPrint",src:"./../assets/static/photos/ThumbPrint.png",style:{width:500}}),e.jsx("div",{className:"col-md-12 text-center",children:e.jsx("button",{className:"btn btn-purple btn-md",disabled:h,children:"Scan & Verify Fingerprint"})})]})})})})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:s!==null&&d==!0?e.jsx("div",{className:"card-header",children:e.jsx("h3",{children:"Sample already collected!!"})}):s!==null&&d==!1?e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"row g-3",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{name:"notes",className:"form-control",onChange:r=>C("notes",r.target.value),children:f.notes})]}),e.jsx("div",{className:"row g-3 align-items-center",children:e.jsx("button",{className:"btn btn-info",disabled:d,onClick:O,children:"Collect Sample"})})]})})})}):e.jsx(e.Fragment,{})})})]})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"row row-cards",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"col-md-12 flex align-items-center",children:e.jsx("div",{className:"col-md-6",style:{float:"left"},children:e.jsx("h3",{children:"Registration Information"})})})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Barcode"}),e.jsx("input",{type:"password",className:"form-control",name:"barcode",value:n,onChange:r=>j(r.target.value)})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Date"}),e.jsx("input",{type:"date",className:"form-control",name:"reg_date",value:o,onChange:r=>N(r.target.value)})]})}),e.jsx("div",{className:"col-4",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Serial Number"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",value:c,onChange:r=>v(r.target.value)})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-2"}),e.jsx("div",{className:"col-4",children:e.jsx("button",{className:"btn btn-md btn-outline-secondary",disabled:!h,onClick:w,children:"Reset Form"})}),e.jsx("div",{className:"col-4",children:e.jsx("button",{className:"btn btn-md btn-outline-info",disabled:h,onClick:S,children:"Search for Candidate"})})]})]})]})}),s&&e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"col-md-12 flex align-items-center",children:e.jsx("div",{className:"col-md-6",style:{float:"left"},children:e.jsx("h3",{children:"Candidate Information"})})})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Candidate Name"}),e.jsx("input",{type:"text",className:"form-control",name:"reg_date",disabled:!0,value:s==null?void 0:s.candidate_name})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Passport Number"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.passport_number})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Passport Issue Date"}),e.jsx("input",{type:"date",className:"form-control",name:"reg_date",disabled:!0,value:s==null?void 0:s.passport_issue_date})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Passport Expiry Date"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.passport_expiry_date})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Registration Date"}),e.jsx("input",{type:"date",className:"form-control",name:"reg_date",disabled:!0,value:s==null?void 0:s.reg_date})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Serial Number"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.serial_no})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Agency"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.agency})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.country})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Profession"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.profession})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Fees"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.fee_charged})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Discount"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.discount})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Relation"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.relation_type})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Relative Name"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.relative_name})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Phone 1"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.phone_1})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Phone 2"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.phone_2})]})})]}),e.jsxs("div",{className:"row g-5",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Marital Status"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:!0,value:s==null?void 0:s.marital_status})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Remarks"}),e.jsx("textarea",{className:"form-control",disabled:!0,children:s==null?void 0:s.remarks})]})})]})]})]})})]})})]})})})]})}export{Q as default};
