import{r as d,W as w,j as e,a as O}from"./app-b520917d.js";import{A as _}from"./AuthenticatedLayout-9847b026.js";import"./TextInput-f96658f4.js";import{Q as R,B as r}from"./ReactToastify-a3207ea2.js";import{I as S}from"./IconRefresh-e01220e9.js";import"./createReactComponent-ec56704d.js";import"./index-d60a9fbe.js";function J(h){const[g,x]=d.useState(null),[m,v]=d.useState(null),[o,u]=d.useState(null);d.useState("None");const{data:s,setData:b,post:P,processing:k,errors:B,reset:H}=w({chest:"",note:"",serial_no:"",remarks:"",date:"",images:""});d.useEffect(()=>{},[]);const n=t=>{t.target.name=="images"?b(t.target.name,t.target.files):b(t.target.name,t.target.value)},f=async t=>{u(null);const l={centre_id:h.auth.user.centre.centre_id,serial_no:m,reg_date:g,process_id:3},i=JSON.stringify(l);if(m==null&&g==null)r.warning("Please select date & serial number to proceed!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"});else try{const c=await r.promise(fetch(route("xray.fetch_result"),{method:"POST",body:i}),{pending:"Fetching XRAY Result"}).then(a=>a.json()).then(a=>{a.xray.length==0?r.warning("No Result Found!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}):(u(a.xray),s.date=a.xray.reg_date,s.serial_no=a.xray.serial_no,s.chest=a.xray.chest,s.notes=a.xray.notes,r.success("Candidate XRAY Result Found!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}))},a=>{r.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}catch{r.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}},C=async t=>{if(j("store")){t.target.disabled=!0;const l={centre_id:h.auth.user.centre.centre_id,date:s.date,serial_no:s.serial_no,notes:s.notes,chest:s.chest,images:s.images},i=JSON.stringify(l);try{const c=await r.promise(fetch(route("lab.store_xray_result"),{method:"POST",body:i}),{pending:"Submitting Form"}).then(a=>a.json()).then(a=>{a.message=="XRAY Result has been saved"?r.success(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}):r.warning(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})},(a,p)=>{r.error(p.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}catch{r.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}t.target.disabled=!1}},y=async t=>{if(j("update")){t.target.disabled=!0;const l={centre_id:h.auth.user.centre.centre_id,date:s.date,serial_no:s.serial_no,notes:s.notes,chest:s.chest,images:s.images},i=JSON.stringify(l);try{const c=await r.promise(fetch(route("lab.update_xray_result"),{method:"POST",body:i}),{pending:"Submitting Form"}).then(a=>a.json()).then(a=>{a.message=="XRAY Result has been updated!"?(N(),r.success(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})):r.warning(a.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})},(a,p)=>{r.error(p.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}catch{r.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}t.target.disabled=!1}},j=t=>{var i;let l=!0;return((i=s.images)==null?void 0:i.length)==0&&t=="store"?(r.warning("Please add at least one image before submitting the form!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),l=!1):s.chest==""&&(r.warning("Please select chest status before submitting the form!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"}),l=!1),l},N=()=>{u(null),s.notes="",s.date="",s.chest="",s.images="",s.serial_no="",x(""),v("")};return e.jsxs(_,{user:h.auth.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"XRAY Result"}),children:[e.jsx(O,{title:"XRAY Result"}),e.jsx(R,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsx("div",{className:"page-header d-print-none",children:e.jsx("div",{className:"container-xl",children:e.jsx("div",{className:"row g-2 align-items-center",children:e.jsxs("div",{className:"col align-items-center",children:[e.jsx("div",{className:"col-md-3",style:{float:"left"},children:e.jsx("h2",{className:"page-title",style:{float:"left"},children:"XRAY Result"})}),e.jsx("div",{className:"col-md-2 align-items-center",style:{float:"right"},children:e.jsx("h2",{className:"page-title",children:e.jsx("button",{className:"btn btn-secondary btn-sm mr-5 btn-pill",onClick:()=>location.reload(),children:e.jsx(S,{})})})})]})})})}),e.jsx("div",{className:"page-body",children:e.jsx("div",{className:"container-xl",children:e.jsxs("div",{className:"row row-cards mb-5",children:[e.jsx("div",{className:"col-md-8",children:e.jsx("div",{className:"row row-cards",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",id:"manual_import",children:[e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Date"}),e.jsx("input",{type:"date",className:"form-control",name:"date",disabled:o!=null,value:s.date,onChange:n})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Serial Number"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",disabled:o!=null,value:s.serial_no,onChange:n})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Chest"}),e.jsxs("select",{className:"form-select",name:"chest",value:s.chest,required:!0,onChange:n,children:[e.jsx("option",{value:"",children:"- SELECT -"}),e.jsx("option",{value:"lung fields clear",children:"LUNG FIELDS CLEAR"}),e.jsx("option",{value:"unfit due to x-ray findings",children:"Unfit Due to X-Ray Findings."}),e.jsx("option",{value:"see notes",children:'"See Notes"'})]})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Images"}),e.jsx("input",{type:"file",className:"form-control",name:"images",multiple:!0,onChange:n})]})})]}),e.jsxs("div",{className:"row g-5",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{className:"form-control",name:"notes",onChange:n,children:s.notes})]})}),o==null?e.jsx("div",{className:"col-6 pt-6",children:e.jsx("button",{class:"btn btn-md btn-outline-success",onClick:C,children:"Save Result"})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsx("input",{type:"text",className:"form-control",name:"images",disabled:!0,value:o.status})]})}),e.jsx("div",{className:"col-3 pt-6",children:e.jsx("button",{class:"btn btn-md btn-outline-primary",onClick:y,children:"Update Result"})})]})]})]})})})})}),e.jsx("div",{className:"col-md-4",children:e.jsx("div",{className:"row row-cards",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{children:"Search Xray Result"})}),e.jsxs("div",{className:"card-body",id:"manual_import",children:[e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Date"}),e.jsx("input",{type:"date",className:"form-control",name:"search_date",value:g,onChange:t=>x(t.target.value)})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Serial Number"}),e.jsx("input",{type:"text",className:"form-control",name:"search_serial_number",value:m,onChange:t=>v(t.target.value)})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"row g-3 align-items-center",children:e.jsx("button",{className:"btn btn-outline-secondary btn-md",disabled:o==null,onClick:N,children:"Reset Form"})})}),e.jsx("div",{className:"col-6",children:e.jsx("div",{className:"row g-3 align-items-center",children:e.jsx("button",{className:"btn btn-outline-primary btn-md",disabled:o!=null,onClick:f,children:"Search Result"})})})]})]})]})})})})]})})})]})}export{J as default};
