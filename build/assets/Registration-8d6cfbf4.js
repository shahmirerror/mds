import{r as d,W as q,j as e,a as G}from"./app-05b46bff.js";import{A}from"./AuthenticatedLayout-d29700ac.js";import"./TextInput-17a4b9aa.js";import{Q as J,B as g}from"./ReactToastify-714af015.js";import{S as h}from"./react-select.esm-4a6a34be.js";import{c as Q}from"./createReactComponent-89f5f90d.js";import"./index-34e21f62.js";var z=Q("refresh","IconRefresh",[["path",{d:"M20 11a8.1 8.1 0 0 0 -15.5 -2m-.5 -4v4h4",key:"svg-0"}],["path",{d:"M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4",key:"svg-1"}]]);function te(i){const[x,_]=d.useState("None"),{data:c,setData:o,post:C,processing:V,errors:X,reset:k}=q({passport_no:"",passport_issue_date:"",passport_expiry_date:"",candidate_name:"",candidate_image:null,agency:"",country:"",profession:"",cnic:"",gender:"",finger_type:"",dob:"",place_of_issue:"",reg_date:"",barcode:i.barcode,serial_no:"",relation_type:"",relative_name:"",phone_1:"",phone_2:"",nationality:"",marital_status:"",biometric_fingerprint:"",fee_charged:"",discount:"",remarks:"",pregnancy_test:0,repeat:!1,token_no:x}),S=[{value:0,label:"L-Thumb"},{value:1,label:"L-Index Finger"},{value:2,label:"L-Middle Finger"},{value:3,label:"L-Ring Finger"},{value:4,label:"L-Pinky Finger"},{value:5,label:"R-Thumb"},{value:6,label:"R-Index Finger"},{value:7,label:"R-Middle Finger"},{value:8,label:"R-Ring Finger"},{value:9,label:"R-Pinky Finger"}];function P(s,a=5e3){return new Promise((t,l)=>{const r=setTimeout(()=>l("Element not found"),a),m=new MutationObserver(v=>{for(const N of v){const w=N.target;if(w.matches(s)){clearTimeout(r),m.disconnect(),t(w);return}}});m.observe(document.body,{childList:!0,subtree:!0}),document.querySelector(s)&&(clearTimeout(r),m.disconnect(),t(document.querySelector(s)))})}const[u,p]=d.useState(!1);d.useState(null);const[j,b]=d.useState(!1),[I,$]=d.useState(""),[D,f]=d.useState(null),[K,R]=d.useState(null),O=s=>{if(u){p(!1);let a=document.getElementById("video"),t=document.getElementById("photo-placeholder");s.target.innerHTML="Turn Camera On",s.target.classList.value="btn btn-success btn-md",D.getTracks().forEach(l=>l.stop()),t.style.display="block",a.style.display="none"}else p(!0),s.target.innerHTML="Turn Camera Off",s.target.classList.value="btn btn-danger btn-md",P("#video").then(a=>{let t=document.getElementById("video"),l=document.getElementById("photo-placeholder");navigator.mediaDevices.getUserMedia({video:!0}).then(r=>{f(r),l.style.display="none",t.style.display="block",t.srcObject=r}).catch(r=>{console.error(r)})}).catch(a=>{console.error(a)})},y=s=>{let a=document.getElementById("video"),t=document.getElementById("taken_photo");const l=document.createElement("canvas");l.width=a.videoWidth,l.height=a.videoHeight,l.getContext("2d").drawImage(a,0,0),t.src=l.toDataURL("image/png"),a.style.display="none",t.style.display="block";const m=new Blob([l.toDataURL("image/png").replace("data:image/png;base64,","")],{type:"image/png"}),v="webcam_photo_"+Date.now()+".png",N=new File([m],v,{type:"image/png"});o("candidate_image",N)},T=()=>{const s={centre_id:i.auth.user.centre.centre_id,process_id:1},a=JSON.stringify(s);try{const t=fetch(route("token.assign"),{method:"POST",body:a}).then(l=>l.json()).then(l=>{_(l.new_token),g.success("New Token has been set!",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})},l=>{g.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})})}catch{g.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})}},E=s=>{s.preventDefault(),T(),k(),p(!1),b(!1),f(!1),R(null)};function B(s){var a;switch(s){case 51:a="System file load failure";break;case 52:a="Sensor chip initialization failed";break;case 53:a="Device not found";break;case 54:a="Fingerprint image capture timeout";break;case 55:a="No device available";break;case 56:a="Driver load failed";break;case 57:a="Wrong Image";break;case 58:a="Lack of bandwidth";break;case 59:a="Device Busy";break;case 60:a="Cannot get serial number of the device";break;case 61:a="Unsupported device";break;case 63:a="SgiBioSrv didn't start; Try image capture again";break;default:a="Unknown error code or Update code to reflect latest result";break}return a}function F(s,a){var t="https://localhost:8443/SGIFPCapture",l=new XMLHttpRequest;l.onreadystatechange=function(){l.readyState==4&&l.status==200?(fpobject=JSON.parse(l.responseText),s(fpobject)):l.status==404&&a(l.status)},l.onerror=function(){a(l.status)};var r="Timeout=10000";r+="&Quality=50",r+="&licstr="+encodeURIComponent(I),r+="&templateFormat=ISO",l.open("POST",t,!0),l.send(r)}function M(s){s.ErrorCode==0?(s!=null&&s.BMPBase64.length>0&&(document.getElementById("fingerPrint").src="data:image/bmp;base64,"+s.BMPBase64),o("biometric_fingerprint",s.TemplateBase64)):alert("Fingerprint Capture Error Code:  "+s.ErrorCode+`.
Description:  `+B(s.ErrorCode)+".")}function L(s){alert("Check if SGIBIOSRV is running; status = "+s+":")}const H=s=>{s.preventDefault(),F(M,L)},U=s=>{g.error("Something went wrong! Please try again :(",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"light"})},n=s=>{o(s.target.name,s.target.value)},W=s=>{C(route("registration-desk.store"))};return d.useEffect(()=>{},[]),e.jsxs(A,{user:i.auth.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Registration Desk"}),children:[e.jsx(G,{title:"Registration Desk"}),e.jsx(J,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsx("div",{className:"page-header d-print-none",children:e.jsx("div",{className:"container-xl",children:e.jsx("div",{className:"row g-2 align-items-center",children:e.jsxs("div",{className:"col align-items-center",children:[e.jsx("div",{className:"col-md-3",style:{float:"left"},children:e.jsx("h2",{className:"page-title",style:{float:"left"},children:"Registration Desk"})}),e.jsx("div",{className:"col-md-3 align-items-center",style:{float:"right"},children:e.jsxs("h2",{className:"page-title",children:[e.jsx("button",{className:"btn btn-secondary btn-sm mr-5 btn-pill",onClick:E,children:e.jsx(z,{})}),e.jsxs("span",{className:"badge",children:["Current Token: ",x!="None"?"M"+x:"None"]})]})})]})})})}),e.jsx("div",{className:"page-body",children:e.jsxs("div",{className:"container-xl",children:[e.jsxs("div",{className:"row row-cards mb-5",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"row row-cards",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"col-md-12 flex align-items-center",children:e.jsx("div",{className:"col-md-4",style:{float:"left"},children:e.jsxs("span",{style:{float:"left"},className:"badge bg-secondary text-white",children:["Barcode Number: ",c.barcode]})})})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("img",{id:"fingerPrint",src:"./../assets/static/photos/ThumbPrint.png",style:{width:500}}),e.jsx("div",{className:"col-md-12 text-center",children:e.jsx("button",{className:"btn btn-purple btn-md w-50",onClick:H,children:"Scan fingerprint"})}),e.jsx("div",{className:"col-md-12 text-center",children:e.jsxs("select",{className:"form-select",name:"finger_type",onChange:n,children:[e.jsx("option",{children:"--"}),S.map((s,a)=>e.jsx("option",{value:s.value,children:s.label}))]})})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("video",{id:"video",autoPlay:!0,muted:!0,style:{height:"290px",display:"none"}}),e.jsx("img",{src:null,id:"taken_photo",style:{width:274,display:"none"},className:"mb-5"}),e.jsx("img",{src:"./../assets/static/photos/Photo.png",className:"mb-5 ",id:"photo-placeholder",style:{width:274}}),e.jsx("div",{className:"col-md-6",children:u&&c.candidate_image==null?e.jsx("button",{className:"btn btn-warning btn-md",onClick:y,children:"Take Photo"}):u&&c.candidate_image!=null?e.jsx("button",{className:"btn btn-warning btn-md",onClick:y,children:"Re-Take Photo"}):e.jsx(e.Fragment,{})}),e.jsx("div",{className:"col-md-6",children:e.jsx("button",{className:"btn btn-success btn-md",onClick:O,children:"Turn Camera On"})})]})})]})})]})})})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"row row-cards",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"col-md-12 flex align-items-center",children:[e.jsx("div",{className:"col-md-6",style:{float:"left"},children:j?e.jsx("h3",{children:"Passport Information"}):e.jsx("button",{className:"btn btn-sm btn-yellow",onClick:U,children:"Import Passport"})}),e.jsx("div",{className:"col-md-6",style:{float:"right"},children:e.jsxs("label",{class:"form-check form-switch",style:{float:"right"},children:[e.jsx("input",{class:"form-check-input",type:"checkbox",checked:j,onChange:s=>b(s.target.checked)}),e.jsx("span",{class:"form-check-label",children:"Manual Entry"})]})})]})}),j?e.jsxs("div",{className:"card-body",id:"manual_import",children:[e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Candidate Name"}),e.jsx("input",{type:"text",className:"form-control",name:"candidate_name",onChange:n})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"PP Issue Date"}),e.jsx("input",{type:"date",className:"form-control",name:"passport_issue_date",onChange:n})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Place of Issue"}),e.jsx(h,{options:i.places,value:c.place_of_issue,name:"place_of_issue",onChange:s=>o("place_of_issue",s)})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"PP Expiry Date"}),e.jsx("input",{type:"date",className:"form-control",name:"passport_expiry_date",onChange:n})]})})]}),e.jsxs("div",{className:"row g-5",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Reference Slip Issue Date"}),e.jsx("input",{type:"date",className:"form-control",name:"ref_slip_issue_date",onChange:n})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Reference Slip Expiry Date"}),e.jsx("input",{type:"date",className:"form-control",name:"ref_slip_expiry_date",onChange:n})]})})]})]}):e.jsxs("div",{className:"card-body",id:"auto_import",children:[e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Place of Issue"}),e.jsx(h,{options:i.places,value:c.place_of_issue,name:"place_of_issue",onChange:s=>o("place_of_issue",s)})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"PP Issue Date"}),e.jsx("input",{type:"date",className:"form-control",name:"passport_issue_date",onChange:n})]})})]}),e.jsxs("div",{className:"row g-5",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Reference Slip Issue Date"}),e.jsx("input",{type:"date",className:"form-control",name:"ref_slip_issue_date",onChange:n})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Reference Slip Expiry Date"}),e.jsx("input",{type:"date",className:"form-control",name:"ref_slip_expiry_date",onChange:n})]})})]})]})]})})})})]}),e.jsxs("div",{className:"row row-cards",children:[e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"row row-cards",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"col-md-12 flex align-items-center",children:e.jsx("div",{className:"col-md-6",style:{float:"left"},children:e.jsx("h3",{children:"General Information"})})})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Registeration Date"}),e.jsx("input",{type:"date",className:"form-control",name:"reg_date",onChange:n})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Serial Number"}),e.jsx("input",{type:"text",className:"form-control",name:"serial_no",onChange:n})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Agency"}),e.jsx(h,{options:i.agencies,value:c.agency,name:"agencies",onChange:s=>o("agency",s)})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx(h,{options:i.countries,value:c.country,name:"country",onChange:s=>o("country",s)})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Profession"}),e.jsx(h,{options:i.professions,value:c.profession,name:"profession",onChange:s=>o("profession",s)})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Fees"}),e.jsx("input",{className:"form-control",name:"fees",type:"text",onChange:n})]})}),e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Discount"}),e.jsx("input",{className:"form-control",name:"discount",type:"text",onChange:n})]})})]})]})]})})})}),e.jsx("div",{className:"col-md-6",children:e.jsx("div",{className:"row row-cards",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"col-md-12 flex align-items-center",children:e.jsx("div",{className:"col-md-6",style:{float:"left"},children:e.jsx("h3",{children:"Candidate Information"})})})}),e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Relation"}),e.jsxs("select",{className:"form-select",name:"relation_type",onChange:n,children:[e.jsx("option",{value:"",children:"Select Relation"}),e.jsx("option",{value:"S/O",children:"S/O"}),e.jsx("option",{value:"W/O",children:"W/O"}),e.jsx("option",{value:"D/O",children:"D/O"})]})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Relative Name"}),e.jsx("input",{type:"text",className:"form-control",name:"relative_name",onChange:n})]})})]}),e.jsxs("div",{className:"row g-5 mb-3",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Phone 1"}),e.jsx("input",{type:"text",className:"form-control",name:"phone_1",onChange:n})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Phone 2"}),e.jsx("input",{type:"text",className:"form-control",name:"phone_2",onChange:n})]})})]}),e.jsxs("div",{className:"row g-5",children:[e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Marital Status"}),e.jsxs("select",{className:"form-select",name:"marital_status",onChange:n,children:[e.jsx("option",{value:"",children:"Select Marital Status"}),e.jsx("option",{value:"Single",children:"Single"}),e.jsx("option",{value:"Married",children:"Married"}),e.jsx("option",{value:"Divorced",children:"Divorced"}),e.jsx("option",{value:"Widowed",children:"Widowed"})]})]})}),e.jsx("div",{className:"col-6",children:e.jsxs("div",{className:"row g-3 align-items-center",children:[e.jsx("label",{className:"form-label",children:"Remarks"}),e.jsx("textarea",{className:"form-control",name:"remarks",onChange:n})]})})]})]}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"row g-5",children:e.jsx("div",{className:"col-12",children:e.jsx("button",{className:"btn btn-outline-success",onClick:W,children:"Submit"})})})})]})})})})]})]})})]})}export{te as default};
